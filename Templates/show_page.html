<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial_scale=150">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" />
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
        <link rel="stylesheet" type="text/css" href="/static/CSS/show_booking.css"/>
        <title>Ticket Book Page</title>
    </head>
    <body>
        <header>
            <div class="header_content">
                <div class="left_align">
                    <a href="{{url_for("home")}}"><img class="logo" src="/static/image/logo.png"></a>
                    <a href="#"><input class="search" placeholder=" &#xf002  Search for Movies,Events.. " style="font-family: FontAwesome;"></a>
                </div>
                <div class="right_align">
                    <p class="user" > Welcome {{user}}
                    <a href="{{url_for("logout")}}"><button>Logout</button></a></p>
                </div>
            </div>
        </header>
        <div class="black_background">
            <div class="image-background">
                <img class="background" src="../{{show["show_image_path"]}}">
                <img class="main_img" src="../{{show["show_image_path"]}}">
                <p class="show_name">{{show["show_name"]}}</p>
                <div class="rating">
                    <form method="POST" action="{{url_for("add_rating", id=show["show_id"])}}">
                        <input type="number" min="1" max="5" rating" name="rating" placeholder="rate movie from 1 to 5" class="rating_box"> <br>
                        <input type="submit" name="/Go" class="rating_submit">
                    </form>
                </div>
                <div class="about_movie">
                    <p class="past_rating"><i class="bi bi-star-fill" style="color: rgb(226, 107, 107);"></i>{{rate_template}} </p>
                    <p class="duration">{{show["show_duration"][0:2] + " hr  " + show["show_duration"][3:5] + " min"}}</p>
                    <p class="language">{{show["show_lang"].upper()}}</p>
                </div>
            </div>
        </div>
        <div class="movie_discription">
            <h3>About the Show</h3>
            <p class="discription"> {{show["show_discription"].capitalize()}}</p>
            <span id="total_cost"></span>
        </div>
        <hr>
        <div class="footer">
            <!-- {% if no_show == False %} -->
                <form method="POST" action="{{url_for("book_ticket")}}">
                    <select class="select" required="True" name="show_venu_id">
                        <option>Select Venu</option>
                        {% for i in range(total_venu_of_show) %}
                            <option value="{{i}}" <-- id="{{i}}" --> >{{venu_with_places[i]}}</option>
                        {% endfor %}
                    </select>
                    <span id="total_cost"></span>
                    <input type="number" min="1" max="9" name="no_of_ticket" id="no_of_ticket" class="no_of_ticket">
                    <button type="submit" name="/Go" class="book_button">Book Ticket</button>
                </form>
            <!-- {% elif no_show == True %} -->
                   <!-- <p class="comming_soon">Coming Soon</p> -->
            <!-- {% endif %} -->
            <script>
                const PriceDict = '{{show_venu_id_with_current_price}}'

                const venueSelect = document.getElementById('venue_select');
                const noOfTicketInput = document.getElementById('no_of_ticket');
                const totalCostOutput = document.getElementById('total_cost');
          
                venueSelect.addEventListener('change', (event) => {
                    const venueId = event.target.value;
                    const currentPrice = PriceDict[venueId];
                  
                    const noOfTickets = noOfTicketInput.value;
                    if (!isNaN(noOfTickets) && noOfTickets > 0 && currentPrice) {
                        const totalCost = noOfTickets * currentPrice;
                        totalCostOutput.textContent = `Total Cost: &#x20b9; ${totalCost}`;
                    } else {
                        totalCostOutput.textContent = "";
                    }
                });
                
                noOfTicketInput.addEventListener('input', (event) => {
                    const noOfTickets = event.target.value;
                    const venueId = venueSelect.value;
                    const currentPrice = PriceDict[venueId];
                  
                    if (!isNaN(noOfTickets) && noOfTickets > 0 && PriceDict) {
                        const totalCost = noOfTickets * PriceDict;
                        totalCostOutput.textContent = `Total Cost: &#x20b9; ${totalCost}`;
                    } else {
                        totalCostOutput.textContent = "";
                    }
                });
            </script>
        </div>
    </body>
</html>